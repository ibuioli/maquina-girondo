var back,linea,times,alTi=0,alFir=0,al1=0,al2=0,ani=!1,otraPagina=!1,noche;function preload(){"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(function(a){loadJSON("https://maps.googleapis.com/maps/api/geocode/json?latlng="+a.coords.latitude+"%2C"+a.coords.longitude+"&language=es",ubicacion),loadJSON("http://api.geonames.org/findNearbyJSON?lat="+a.coords.latitude+"&lng="+a.coords.longitude+"&lang=es&style=short&username=ibuioli",tipoTerreno);var c="https://maps.googleapis.com/maps/api/place/nearbysearch/json?location="+a.coords.latitude+","+a.coords.longitude+"&language=es&rankby=distance&types=establishment&key=AIzaSyCXodxfGv7qhVkx4-KJcAbFisjm020GvQI";fetch("https://cors-anywhere.herokuapp.com/"+c).then(d=>d.json()).then(d=>{sitios(d)}).catch(d=>{alert(d)})}),back=loadImage("https://ibuioli.com.ar/maquina-girondo/data/back.jpg"),times=loadFont("https://ibuioli.com.ar/maquina-girondo/data/timesbd.otf"),19<=hour()||0<=hour()&&5>=hour()?(noche=!0,tema=1):(noche=!1,tema=floor(random(0,3.99)))}function setup(){createCanvas(windowWidth,windowHeight),est_1=new Estrofa(byte(floor(random(3,7.99)))),est_2=new Estrofa(byte(floor(random(3,6.99)))),est_3=new Estrofa(byte(floor(random(2,5.99)))),est_4=new Estrofa(byte(floor(random(5,7.99)))),est_5=new Estrofa(byte(floor(random(4,7.99)))),ti=new Titulo(est_1.texto()+" "+est_2.texto()+" "+est_3.texto()+" "+est_4.texto()+" "+est_5.texto()),noStroke(),textFont(times),frameRate(60)}function draw(){background(233,226,198),imageMode(CORNER),image(back,0,0,width/2,height),width<height?image(back,0,0,width,height):(image(back,0,0,width/2,height),image(back,width/2,0,width/2,height),imageMode(CENTER));var a=est_1.c+est_2.c+est_3.c,b=est_4.c+est_5.c;if(""==lug||lug==void 0)var c=mes()+"  "+year()+".";else var c=lug+",  "+mes()+"  "+year()+".";!0==ani?(alTi-=15,al1-=15,al2-=15,alFir-=15,-20==alFir&&(est_1=new Estrofa(byte(floor(random(3,7.99)))),est_2=new Estrofa(byte(floor(random(3,6.99)))),est_3=new Estrofa(byte(floor(random(2,5.99)))),est_4=new Estrofa(byte(floor(random(5,7.99)))),est_5=new Estrofa(byte(floor(random(4,7.99)))),ti=new Titulo(est_1.texto()+" "+est_2.texto()+" "+est_3.texto()+" "+est_4.texto()+" "+est_5.texto()),ani=!1)):(250>alTi&&(alTi+=10),100<alTi&&250>al1&&(al1+=10),100<al1&&250>al2&&(al2+=10),100<al2&&250>alFir&&(alFir+=10)),fill(10,8,0,alTi),textAlign(CENTER,TOP),textSize(map(width,800,1980,24,36)),textLeading(map(width,800,1980,24,36)),width<height?(textSize(map(width,800,1980,32,48)),textLeading(map(width,800,1980,32,48)),text(ti.texto().toUpperCase(),0,map(a,10,18,40,30),width,60),text(ti.texto().toUpperCase(),1,map(a,10,18,40,30),width,60),text(ti.texto().toUpperCase(),-1,map(a,10,18,40,30),width,60)):(text(ti.texto().toUpperCase(),0,map(a,10,18,90,30),width/2,60),text(ti.texto().toUpperCase(),1,map(a,10,18,90,30),width/2,60),text(ti.texto().toUpperCase(),-1,map(a,10,18,90,30),width/2,60)),textAlign(LEFT,TOP),textSize(map(width,800,1980,16,30)),textLeading(map(width,800,1980,16,30)),fill(10,8,0,al1),width<height?(textSize(map(width,800,1980,24,38)),textLeading(map(width,800,1980,24,38)),text(est_1.texto()+" "+est_2.texto()+" "+est_3.texto(),map(width,800,1980,35,86),map(a,10,18,110,70)+map(height,600,768,20,70),width-map(width,800,1980,50,90),height)):(text(est_1.texto()+"\n\n"+est_2.texto()+"\n\n"+est_3.texto(),map(width,800,1980,35,86),map(a,10,18,200,90)+map(height,600,768,20,70),width/2-map(width,800,1980,50,90),height),fill(10,8,0,al2),text(est_4.texto()+"\n\n"+est_5.texto(),width-width/2+map(width,800,1980,35,86),40,width/2-map(width,800,1980,40,90),height)),textAlign(RIGHT,BOTTOM),textSize(map(width,800,1980,12,20)),fill(10,8,0,alFir),width<height?(textSize(map(width,800,1980,16,22)),text(c.toUpperCase(),width-40,height-20)):text(c.toUpperCase(),width-40,height-map(b,9,14,280,150)-map(height,600,1080,1,70)),otraPagina=!!(250<=alFir)&&mouseX>=width-50&&mouseX<=width-50+50&&mouseY>=height-50&&mouseY<=height-50+50,otraPagina?(cursor(HAND),fill(10,255)):(cursor(ARROW),fill(10,100*cos(frameCount/6)+140)),triangle(width,height,width-50,height,width,height-50)}function mousePressed(){otraPagina&&(ani=!0)}function keyPressed(){if(113==keyCode){var a=fullscreen();fullscreen(!a)}}function windowResized(){resizeCanvas(windowWidth,windowHeight)}function ubicacion(a){if(0!==a.results.length){for(var b=0;b<a.results[0].address_components.length;b++)if(1<a.results[0].address_components[b].types.length){lug=a.results[0].address_components[b].short_name;break}}else lug=""}function tipoTerreno(a){0!==a.geonames.length&&("H"===a.geonames[0].fcl||"T"===a.geonames[0].fcl||"U"===a.geonames[0].fcl?noche?tema=1:tema=3:"L"===a.geonames[0].fcl||"V"===a.geonames[0].fcl?noche?tema=1:tema=2:noche?tema=1:tema=0)}function sitios(a){if("OK"==a.status)for(var b=0;b<a.results.length;b++)slug[b]=limpiarSitios(a.results[b].name),slug_pro[b]=a.results[b].types[0];else slug=[],slug_pro=[]}